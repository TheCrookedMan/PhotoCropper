!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(self,(function(){return(()=>{var t={508:(t,e,i)=>{(e=i(645)(!1)).push([t.id,".cropper-container {\n  direction: ltr;\n  font-size: 0;\n  line-height: 0;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n  padding-left: 5px;\n}\n.cropper-container img {\n  display: block;\n  height: 100%;\n  image-orientation: 0deg;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n.cropper-wrap-box,\n.cropper-canvas,\n.cropper-drag-box,\n.cropper-crop-box,\n.cropper-modal {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.cropper-drag-box {\n  margin-top: -5px;\n  margin-right: -5px;\n  margin-bottom: -5px;\n}\n.cropper-modal {\n  background-color: #000;\n  opacity: 0.5;\n}\n.cropper-hidden {\n  display: none !important;\n}\n.cropper-hide {\n  display: block;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.cropper-crop {\n  cursor: crosshair;\n}\n.cropper-wrap-box {\n  bottom: 0;\n  left: 5px;\n  position: absolute;\n  right: 0;\n  top: 0;\n  overflow: hidden;\n}\n.cropper-crop-box {\n  bottom: 0;\n  left: 5px;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.cropper-crop-box .cropper-view-box {\n  display: block;\n  height: 100%;\n  outline-color: #fff;\n  outline: 2px solid #fff;\n  overflow: hidden;\n  width: 100%;\n}\n.cropper-crop-box .cropper-view-box > img {\n  max-width: inherit;\n}\n.cropper-crop-box .cropper-dashed {\n  border: 0 solid #fff;\n  display: block;\n  opacity: 0.7;\n  position: absolute;\n}\n.cropper-crop-box .cropper-dashed.dashed-h {\n  border-bottom-width: 2px;\n  border-top-width: 2px;\n  height: 33.33333%;\n  left: 0;\n  top: 33.33333%;\n  width: 100%;\n}\n.cropper-crop-box .cropper-dashed.dashed-v {\n  border-left-width: 2px;\n  border-right-width: 2px;\n  height: 100%;\n  left: 33.33333%;\n  top: 0;\n  width: 33.33333%;\n}\n.cropper-crop-box .cropper-move {\n  cursor: move;\n}\n.cropper-crop-box .cropper-face {\n  background-color: #fff;\n  left: 0;\n  top: 0;\n  display: block;\n  height: 100%;\n  opacity: 0.1;\n  position: absolute;\n  width: 100%;\n}\n.cropper-crop-box .cropper-line {\n  display: block;\n  height: 100%;\n  opacity: 0.1;\n  position: absolute;\n}\n.cropper-crop-box .cropper-line.line-e {\n  cursor: ew-resize;\n  right: -3px;\n  top: 0;\n  width: 3px;\n  padding-left: 0px;\n}\n.cropper-crop-box .cropper-line.line-n {\n  cursor: ns-resize;\n  height: 3px;\n  left: 0;\n  top: -3px;\n  width: 100%;\n  padding-bottom: 0px;\n}\n.cropper-crop-box .cropper-line.line-w {\n  cursor: ew-resize;\n  left: -3px;\n  top: 0;\n  width: 3px;\n  padding-right: 0px;\n}\n.cropper-crop-box .cropper-line.line-s {\n  bottom: -3px;\n  cursor: ns-resize;\n  height: 3px;\n  left: 0;\n  width: 100%;\n  padding-top: 0px;\n}\n.cropper-crop-box .cropper-point {\n  display: block;\n  position: absolute;\n  background-color: inherit;\n  text-transform: none;\n}\n.cropper-crop-box .cropper-point.point-ne {\n  border-top: 5px solid #fff;\n  border-right: 5px solid #fff;\n  width: 15px;\n  top: -5px;\n  height: 15px;\n  right: -5px;\n}\n.cropper-crop-box .cropper-point.point-nw {\n  border-top: 5px solid #fff;\n  border-left: 5px solid #fff;\n  width: 15px;\n  top: -5px;\n  height: 15px;\n  left: -5px;\n}\n.cropper-crop-box .cropper-point.point-sw {\n  border-bottom: 5px solid #fff;\n  border-left: 5px solid #fff;\n  width: 15px;\n  bottom: -5px;\n  height: 15px;\n  left: -5px;\n}\n.cropper-crop-box .cropper-point.point-se {\n  border-bottom: 5px solid #fff;\n  border-right: 5px solid #fff;\n  width: 15px;\n  bottom: -5px;\n  height: 15px;\n  right: -5px;\n}\n",""]),t.exports=e},164:(t,e,i)=>{(e=i(645)(!1)).push([t.id,".discoloration-container {\n  direction: ltr;\n  font-size: 0;\n  line-height: 0;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n}\n.discoloration-container img,\n.discoloration-container canvas {\n  display: block;\n  height: 100%;\n  image-orientation: 0deg;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n.discoloration-container img {\n  filter: grayscale(1);\n}\n.discoloration-container canvas {\n  z-index: 1;\n  position: absolute;\n}\n.discoloration-wrap-box,\n.discoloration-canvas {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.discoloration-hide {\n  display: block;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.discoloration-hidden {\n  display: none !important;\n}\n",""]),t.exports=e},480:(t,e,i)=>{(e=i(645)(!1)).push([t.id,".doodle-container {\n  direction: ltr;\n  font-size: 0;\n  line-height: 0;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n}\n.doodle-container img,\n.doodle-container canvas {\n  display: block;\n  height: 100%;\n  image-orientation: 0deg;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n.doodle-container canvas {\n  z-index: 1;\n  position: absolute;\n}\n.doodle-wrap-box,\n.doodle-canvas {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.doodle-hide {\n  display: block;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.doodle-hidden {\n  display: none !important;\n}\n",""]),t.exports=e},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i,n,o,a=t[1]||"",r=t[3];if(!r)return a;if(e&&"function"==typeof btoa){var s=(i=r,n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(o," */")),h=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[a].concat(h).concat([s]).join("\n")}return[a].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(n)for(var a=0;a<this.length;a++){var r=this[a][0];null!=r&&(o[r]=!0)}for(var s=0;s<t.length;s++){var h=[].concat(t[s]);n&&o[h[0]]||(i&&(h[2]?h[2]="".concat(i," and ").concat(h[2]):h[2]=i),e.push(h))}},e}},676:(t,e,i)=>{var n=i(508);"string"==typeof n&&(n=[[t.id,n,""]]);i(723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(t.exports=n.locals)},89:(t,e,i)=>{var n=i(164);"string"==typeof n&&(n=[[t.id,n,""]]);i(723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(t.exports=n.locals)},511:(t,e,i)=>{var n=i(480);"string"==typeof n&&(n=[[t.id,n,""]]);i(723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(t.exports=n.locals)},723:(t,e,i)=>{var n,o,a={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),s=function(t,e){return e?e.querySelector(t):document.querySelector(t)},h=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=s.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),l=null,c=0,d=[],p=i(947);function g(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=a[n.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](n.parts[r]);for(;r<n.parts.length;r++)o.parts.push(b(n.parts[r],e))}else{var s=[];for(r=0;r<n.parts.length;r++)s.push(b(n.parts[r],e));a[n.id]={id:n.id,refs:1,parts:s}}}}function u(t,e){for(var i=[],n={},o=0;o<t.length;o++){var a=t[o],r=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[r]?n[r].parts.push(s):i.push(n[r]={id:r,parts:[s]})}return i}function m(t,e){var i=h(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=d[d.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),d.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=h(t.insertAt.before,i);i.insertBefore(e,o)}}function f(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=d.indexOf(t);e>=0&&d.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=i.nc;n&&(t.attrs.nonce=n)}return w(e,t.attrs),m(t,e),e}function w(t,e){Object.keys(e).forEach((function(i){t.setAttribute(i,e[i])}))}function b(t,e){var i,n,o,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var r=c++;i=l||(l=v(e)),n=D.bind(null,i,r,!1),o=D.bind(null,i,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",w(e,t.attrs),m(t,e),e}(e),n=M.bind(null,i,e),o=function(){f(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(e),n=C.bind(null,i),o=function(){f(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=r()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=u(t,e);return g(i,e),function(t){for(var n=[],o=0;o<i.length;o++){var r=i[o];(s=a[r.id]).refs--,n.push(s)}for(t&&g(u(t,e),e),o=0;o<n.length;o++){var s;if(0===(s=n[o]).refs){for(var h=0;h<s.parts.length;h++)s.parts[h]();delete a[s.id]}}}};var x,y=(x=[],function(t,e){return x[t]=e,x.filter(Boolean).join("\n")});function D(t,e,i,n){var o=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var a=document.createTextNode(o),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(a,r[e]):t.appendChild(a)}}function C(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function M(t,e,i){var n=i.css,o=i.sourceMap,a=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||a)&&(n=p(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}},947:t=>{t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var o,a=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={id:n,exports:{}};return t[n](a,a.exports,i),a.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";i.r(n),i.d(n,{Cropper:()=>ct,DisColorAtion:()=>Qt,Doodle:()=>Ut});var t="undefined"!=typeof window,e=t?window:{},o="cropper",a=!!t&&"ontouchstart"in e.document.documentElement,r=!!t&&"PointerEvent"in e,s=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,h=/^img|canvas$/i,l=/^data:image\/jpeg;base64,/,c="image/jpeg",d=("".concat(o,"-crop"),"".concat(o,"-disabled"),"".concat(o,"-hidden")),p="".concat(o,"-hide"),g=("".concat(o,"-invisible"),"".concat(o,"-modal"),"".concat(o,"-move")),u="".concat(o,"Action"),m=("".concat(o,"Preview"),r?"pointerdown":a?"touchstart":"mousedown"),f=r?"pointermove":a?"touchmove":"mousemove",v=r?"pointerup pointercancel":a?"touchend touchcancel":"mouseup";const w={cropModel:"freedom",initialAspectRatio:NaN,aspectRatio:NaN,cropMinW:50,cropMinH:50,outPutImageType:c,outPutImageDefinition:1,initCropBoxWidth:NaN,initCropBoxHeight:100,onReady:null};var b="undefined"!=typeof window,x=b?window:{},y=Number.isNaN||x.isNaN;function D(t){return"number"==typeof t&&!y(t)}var C=t=>t>0&&t<1/0;function M(t){return"object"==typeof t&&null!==t}var{hasOwnProperty:S}=Object.prototype;function T(t){if(!M(t))return!1;try{var{constructor:e}=t,{prototype:i}=e;return e&&i&&S.call(i,"isPrototypeOf")}catch(t){return!1}}var{slice:L}=Array.prototype;function E(t){return Array.from?Array.from(t):L.call(t)}function W(t,e){return t&&"function"==typeof e&&(Array.isArray(t)||D(t.length)?E(t).forEach(((i,n)=>{e.call(t,i,n,t)})):M(t)&&Object.keys(t).forEach((i=>{e.call(t,t[i],i,t)}))),t}var O=Object.assign||function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return M(t)&&i.length>0&&i.forEach((e=>{M(e)&&Object.keys(e).forEach((i=>{t[i]=e[i]}))})),t},{fromCharCode:H}=String,R=/^data:.*,/;function B(t){var e=t.replace(R,""),i=atob(e),n=new ArrayBuffer(i.length),o=new Uint8Array(n);return W(o,((t,e)=>{o[e]=i.charCodeAt(e)})),n}var{location:k}=x,I=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function N(t){var e=t.match(I);return null!==e&&(e[1]!==k.protocol||e[2]!==k.hostname||e[3]!==k.port)}function U(t,e){for(var i=[],n=new Uint8Array(t);n.length>0;)i.push(H.apply(null,E(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(i.join("")))}function z(t){var e,i=new DataView(t);try{var n,o,a;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var r=i.byteLength,s=2;s+1<r;){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){o=s;break}s+=1}if(o){var h=o+10;if("Exif"===function(t,e,i){var n="";i+=e;for(var o=e;o<i;o+=1)n+=H(t.getUint8(o));return n}(i,o+4,4)){var l=i.getUint16(h);if(((n=18761===l)||19789===l)&&42===i.getUint16(h+2,n)){var c=i.getUint32(h+4,n);c>=8&&(a=h+c)}}}if(a){var d,p,g=i.getUint16(a,n);for(p=0;p<g;p+=1)if(d=a+12*p+2,274===i.getUint16(d,n)){d+=8,e=i.getUint16(d,n),i.setUint16(d,1,n);break}}}catch(t){e=1}return e}function P(t){var e=0,i=1,n=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:n=-1;break;case 5:e=90,n=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90}return{rotate:e,scaleX:i,scaleY:n}}function X(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function Y(t){var{rotate:e,scaleX:i,scaleY:n,translateX:o,translateY:a}=t,r=[];D(o)&&0!==o&&r.push("translateX(".concat(o,"px)")),D(a)&&0!==a&&r.push("translateY(".concat(a,"px)")),D(e)&&0!==e&&r.push("rotate(".concat(e,"deg)")),D(i)&&1!==i&&r.push("scaleX(".concat(i,")")),D(n)&&1!==n&&r.push("scaleY(".concat(n,")"));var s=r.length?r.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}var j=/^width|height|left|top|marginLeft|marginTop$/;function A(t,e){var{style:i}=t;W(e,((t,e)=>{j.test(e)&&D(t)&&(t="".concat(t,"px")),i[e]=t}))}function q(t,e){if(e)if(D(t.length))W(t,(t=>{q(t,e)}));else if(t.classList)t.classList.add(e);else{var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function $(t,e){e&&(D(t.length)?W(t,(t=>{$(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}var F=/([a-z\d])([A-Z])/g;function G(t){return t.replace(F,"$1-$2").toLowerCase()}var J=/\s\s*/,Q=(()=>{var t=!1;if(b){var e=!1,i=()=>{},n=Object.defineProperty({},"once",{get:()=>(t=!0,e),set(t){e=t}});x.addEventListener("test",i,n),x.removeEventListener("test",i,n)}return t})();function _(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i;e.trim().split(J).forEach((e=>{if(!Q){var{listeners:a}=t;a&&a[e]&&a[e][i]&&(o=a[e][i],delete a[e][i],0===Object.keys(a[e]).length&&delete a[e],0===Object.keys(a).length&&delete t.listeners)}t.removeEventListener(e,o,n)}))}function V(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i;e.trim().split(J).forEach((e=>{if(n.once&&!Q){var{listeners:a={}}=t;o=function(){delete a[e][i],t.removeEventListener(e,o,n);for(var r=arguments.length,s=new Array(r),h=0;h<r;h++)s[h]=arguments[h];i.apply(t,s)},a[e]||(a[e]={}),a[e][i]&&t.removeEventListener(e,a[e][i],n),a[e][i]=o,t.listeners=a}t.addEventListener(e,o,n)}))}function Z(t,e){var{pageX:i,pageY:n}=t,o={endX:i,endY:n};return e?o:O({startX:i,startY:n},o)}function K(t){var{aspectRatio:e,height:i,width:n}=t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",a=C(n),r=C(i);if(a&&r){var s=i*e;"contain"===o&&s>n||"cover"===o&&s<n?i=n/e:n=i*e}else a?i=n/e:r&&(n=i*e);return{width:n,height:i}}var tt=/\.\d*(?:0|9){12}\d*$/;function et(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return tt.test(t)?Math.round(t*e)/e:t}function it(t,e,i,n){var{aspectRatio:o,naturalWidth:a,naturalHeight:r,rotate:s=0,scaleX:h=1,scaleY:l=1}=e,{aspectRatio:c,naturalWidth:d,naturalHeight:p}=i,{fillColor:g="transparent",imageSmoothingEnabled:u=!0,imageSmoothingQuality:m="low",maxWidth:f=1/0,maxHeight:v=1/0,minWidth:w=0,minHeight:b=0}=n,x=document.createElement("canvas"),y=x.getContext("2d"),D=K({aspectRatio:c,width:f,height:v}),C=K({aspectRatio:c,width:w,height:b},"cover"),M=Math.min(D.width,Math.max(C.width,d)),S=Math.min(D.height,Math.max(C.height,p)),T=K({aspectRatio:o,width:f,height:v}),L=K({aspectRatio:o,width:w,height:b},"cover"),E=Math.min(T.width,Math.max(L.width,a)),W=Math.min(T.height,Math.max(L.height,r)),O=[-E/2,-W/2,E,W];return x.width=et(M),x.height=et(S),y.fillStyle=g,y.fillRect(0,0,M,S),y.save(),y.translate(M/2,S/2),y.rotate(s*Math.PI/180),y.scale(h,l),y.imageSmoothingEnabled=u,y.imageSmoothingQuality=m,y.drawImage(t,...O.map((t=>Math.floor(et(t))))),y.restore(),x}const nt={render(){this.initContainer(),this.initCanvas(),this.initCropBox()},initContainer(){var{element:t,options:e,container:i,cropper:n}=this,o={width:i.offsetWidth-10,height:i.offsetHeight-10};this.containerData=o,A(n,{width:o.width,height:o.height})},initCanvas(){var{containerData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,a=n/o,r=t.width,s=t.height;a>r/s?s=n>t.width?(r=t.width)/a:(r=n)/a:r=o>t.height?(s=t.height)*a:(s=o)*a;var h={aspectRatio:a,naturalWidth:n,naturalHeight:o,width:r,height:s};h.left=(t.width-r)/2,h.top=(t.height-s)/2,this.canvasData=h;var{canvas:l}=this;A(l,O({width:h.width,height:h.height},Y({translateX:h.left,translateY:h.top}))),O(this.imageData,{width:h.width,height:h.height,left:0,top:0}),this.renderImage()},renderCanvas(t,e){var{canvasData:i,imageData:n,containerData:o}=this;if(e){var a,r,{width:s,height:h}=function(t){var{width:e,height:i,degree:n}=t;if(90==(n=Math.abs(n)%180))return{width:i,height:e};var o=n%90*Math.PI/180,a=Math.sin(o),r=Math.cos(o),s=e*r+i*a,h=e*a+i*r;return n>90?{width:h,height:s}:{width:s,height:h}}({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),l=s/h;o.width/o.height<l?r=(a=o.width-10)/l:a=(r=o.height-10)*l,i.left-=(a-i.width)/2,i.top-=(r-i.height)/2,i.width=a,i.height=r,i.aspectRatio=s/h,i.naturalWidth=s,i.naturalHeight=h,this.canvasData=i}A(this.canvas,O({width:i.width,height:i.height},Y({translateX:i.left,translateY:i.top}))),this.limitCropBox(),this.renderImage(t)},renderImage(t){var{canvasData:e,imageData:i}=this,n=i.naturalWidth*(e.width/e.naturalWidth),o=i.naturalHeight*(e.height/e.naturalHeight);this.imageData=O(i,{width:n,height:o,left:(e.width-n)/2,top:(e.height-o)/2}),A(this.image,O({width:i.width,height:i.height},Y(O({translateX:i.left,translateY:i.top},i)))),t&&this.output()},initDragBox(){var{dragBox:t}=this;q(t,"cropper-crop"),q(t,"cropper-modal")},initCropBox(){this.initDragBox();var{options:t,cropBox:e,canvasData:i,imageData:n}=this,o={width:t.initCropBoxWidth||i.width,height:(t.initCropBoxHeight<i.height?t.initCropBoxHeight:i.height)||i.height,top:i.top,left:i.left};o.top+=(i.height-o.height)/2,o.left+=(i.width-o.width)/2,"freedom"===t.cropModel&&A(e,O({width:o.width,height:o.height},Y({translateX:o.left,translateY:o.top})));var a=i.left+i.width,r=i.top+i.height;this.cropBoxData=O(o,{minWidth:t.cropMinW,minHeight:t.cropMinH},{maxWidth:i.width,maxHeight:i.height,minLeft:i.left,minTop:i.top,maxLeft:a,maxTop:r}),this.output()},limitCropBox(){var{cropBoxData:t,canvasData:e}=this;O(t,{minWidth:w.cropMinW,minHeight:w.cropMinH},{maxWidth:e.width,maxHeight:e.height,minLeft:e.left,minTop:e.top,maxLeft:e.left+e.width,maxTop:e.top+e.height}),t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),t.left=Math.min(Math.max(t.left,t.minLeft),t.maxLeft-t.width),t.top=Math.min(Math.max(t.top,t.minTop),t.maxTop-t.height),t.oldLeft=t.left,t.oldTop=t.top,this.cropBoxData=t,A(this.cropBox,O({width:t.width,height:t.height},Y({translateX:t.left,translateY:t.top})))},renderCropBox(){var{cropBoxData:t}=this;(t.width>t.maxWidth||t.width<t.minWidth)&&void 0!==t.oldLeft&&(t.left=t.oldLeft),(t.height>t.maxHeight||t.height<t.minHeight)&&void 0!==t.oldTop&&(t.top=t.oldTop),t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),t.left=Math.min(Math.max(t.left,t.minLeft),t.maxLeft),t.top=Math.min(Math.max(t.top,t.minTop),t.maxTop),t.oldLeft=t.left,t.oldTop=t.top,A(this.cropBox,O({width:t.width,height:t.height},Y({translateX:t.left,translateY:t.top}))),this.output()},output(){this.preview()}},ot={initPreview(){var{crossOrigin:t}=this,e=t?this.crossOriginUrl:this.url,i=document.createElement("img");t&&(i.crossOrigin=t),i.src=e,this.viewBox.appendChild(i),this.viewBoxImage=i},preview(){var{canvasData:t,cropBoxData:e,imageData:i}=this,n=i.naturalWidth*(t.width/t.naturalWidth),o=i.naturalHeight*(t.height/t.naturalHeight),a=e.left-t.left-(D(i.left)?i.left:0),r=e.top-t.top-(D(i.top)?i.top:0);A(this.viewBoxImage,O({width:n,height:o},Y(O({translateX:-a,translateY:-r},i))))}},at={bind(){var{element:t}=this;V(t.ownerDocument,m,this.onCropStart=this.cropStart.bind(this)),V(t.ownerDocument,f,this.onCropMove=this.cropMove.bind(this)),V(t.ownerDocument,v,this.onCropEnd=this.cropEnd.bind(this))},unbind(){var{element:t}=this;_(t.ownerDocument,m,this.onCropStart),_(t.ownerDocument,f,this.onCropMove),_(t.ownerDocument,v,this.onCropEnd)}},rt={cropStart(t){var e,i,n,{pointers:o}=this;t.changedTouches?W(t.changedTouches,(t=>{o[0]=Z(t)})):o[0]=Z(t),e=M((i=t.target)[n=u])?i[n]:i.dataset?i.dataset[n]:i.getAttribute("data-".concat(G(n))),s.test(e)&&(t.preventDefault(),t.stopPropagation(),this.action=e)},cropMove(t){this.startEventTimer=Date.now();var{action:e}=this;if(e){var{pointers:i}=this;t.preventDefault(),t.stopPropagation(),t.changedTouches?W(t.changedTouches,(t=>{O(i[0]||{},Z(t,!0))})):O(i[0]||{},Z(t,!0)),this.change(t)}},cropEnd(t){var{action:e,pointers:i}=this;t.changedTouches?W(t.changedTouches,(t=>{delete i[0]})):delete i[0],e&&(Object.keys(i).length||(this.action=""),t.preventDefault(),t.stopPropagation())}},st={change(t){var{cropBoxData:e,pointers:i}=this,{action:n}=this,{left:o,top:a,width:r,height:s,minLeft:h,minTop:l,maxLeft:c,maxTop:d}=e,p=!0,g=i[Object.keys(i)[0]],u=g.endX-g.startX,m=g.endY-g.startY;switch(n){case"ne":a+=m,o+(r+=u)>c&&(p=!1),m<0&&a<=l&&(p=!1),s-=m;break;case"nw":o+=u,a+=m,u<0&&o<=h&&(p=!1),m<0&&a<=l&&(p=!1),r-=u,s-=m;break;case"se":o+(r+=u)>c&&(p=!1),a+(s+=m)>d&&(p=!1);break;case"sw":o+=u,u<0&&o<=h&&(p=!1),r-=u,a+(s+=m)>d&&(p=!1);break;case"all":(o+=u)+r>c&&(p=!1),(a+=m)+s>d&&(p=!1)}p&&(e.width=r,e.height=s,e.left=o,e.top=a,this.renderCropBox()),W(i,(t=>{t.startX=t.endX,t.startY=t.endY}))}},ht={scaleX(){var{scaleY:t,scaleX:e}=this.imageData;return this.scale(D(e)?-e:-1,D(t)?t:1)},scaleY(){var{scaleY:t,scaleX:e}=this.imageData;return this.scale(D(e)?e:1,D(t)?-t:-1)},scale(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,{imageData:i}=this,n=!1;return t=Number(t),e=Number(e),D(t)&&(i.scaleX=t,n=!0),D(e)&&(i.scaleY=e,n=!0),n&&(this.renderCanvas(!0,!0),this.renderCropBox()),this},rotate(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo(t){return D(t=Number(t))&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},getCroppedCanvas(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!window.HTMLCanvasElement)return null;var{canvasData:e}=this,i=it(this.image,this.imageData,e,t),{x:n,y:o,width:a,height:r}=this.getData(),s=i.width/Math.floor(e.naturalWidth);1!==s&&(n*=s,o*=s,a*=s,r*=s);var h=a/r,l=K({aspectRatio:h,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),c=K({aspectRatio:h,width:t.minWidth||0,height:t.minHeight||0},"cover"),{width:d,height:p}=K({aspectRatio:h,width:t.width||(1!==s?i.width:a),height:t.height||(1!==s?i.height:r)});d=Math.min(l.width,Math.max(c.width,d)),p=Math.min(l.height,Math.max(c.height,p));var g=document.createElement("canvas"),u=g.getContext("2d");g.width=et(d),g.height=et(p),u.fillStyle=t.fillColor||"transparent",u.fillRect(0,0,d,p);var{imageSmoothingEnabled:m=!0,imageSmoothingQuality:f}=t;u.imageSmoothingEnabled=m,f&&(u.imageSmoothingQuality=f);var v,w,b,x,y,D,C=i.width,M=i.height,S=n,T=o;S<=-a||S>C?(S=0,v=0,b=0,y=0):S<=0?(b=-S,S=0,y=v=Math.min(C,a+S)):S<=C&&(b=0,y=v=Math.min(a,C-S)),v<=0||T<=-r||T>M?(T=0,w=0,x=0,D=0):T<=0?(x=-T,T=0,D=w=Math.min(M,r+T)):T<=M&&(x=0,D=w=Math.min(r,M-T));var L=[S,T,v,w];if(y>0&&D>0){var E=d/a;L.push(b*E,x*E,y*E,D*E)}return u.drawImage(i,...L.map((t=>Math.floor(et(t))))),g},getData(){var t,{imageData:e,canvasData:i,cropBoxData:n}=this;t={x:n.left-i.left,y:n.top-i.top,width:n.width,height:n.height};var o=e.width/e.naturalWidth;return W(t,((e,i)=>{t[i]=e/o})),t.rotate=e.rotate||0,t.scaleX=e.scaleX||1,t.scaleY=e.scaleY||1,t},toDataURL(){var{outPutImageType:t,outPutImageDefinition:e}=this.options;return this.getCroppedCanvas().toDataURL(t,e)},toBlob(t){var{outPutImageType:e,outPutImageDefinition:i}=this.options;this.getCroppedCanvas().toBlob(t,e,i)},destroy(){var{element:t}=this;if(!t.cropper)return this;t.cropper=void 0,t.src=this.originalUrl,this.unbind(),this.cropper.parentNode.removeChild(this.cropper),$(this.element,d)}};i(676);class lt{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!h.test(t.tagName))throw new Error("主元素必须为<img> 或者 <canvas> 元素.");this.element=t,this.options=O({},w,T(e)&&e),this.pointers={},this.sized=!1,this.sizing=!1,this.init()}init(){var t,{element:e}=this,i=e.tagName.toLowerCase();if(!e.cropper){if(e.cropper=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}load(t){if(t){this.url=t,this.imageData={};var{element:e,options:i}=this;if(l.test(t))this.read(B(t));else{var n=new XMLHttpRequest,o=this.clone.bind(this);this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=()=>{},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.xhr=null},i.checkCrossOrigin&&N(t)&&e.crossOrigin&&(t=X(t)),n.open("GET",t),n.responseType="arraybuffer",n.withCredentials="use-credentials"===e.crossOrigin,n.send()}}}read(t){var{imageData:e}=this,i=z(t),n=0,o=1,a=1;i>1&&(this.url=U(t,c),({rotate:n,scaleX:o,scaleY:a}=P(i))),e.rotate=n,e.scaleX=o,e.scaleY=a,this.clone()}clone(){var t,e,{element:i,url:n}=this;this.options.checkCrossOrigin&&N(n)&&(({crossOrigin:t}=i),t||(t="anonymous"),e=X(n)),this.crossOrigin=t,this.crossOriginUrl=e;var o=document.createElement("img");t&&(o.crossOrigin=t),o.src=e||n,this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),q(o,p),i.parentNode.insertBefore(o,i.nextSibling)}start(){var t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var i=e.navigator&&/^(?:.(?!chrome|android))*safari/i.test(e.navigator.userAgent),n=(t,e)=>{O(this.imageData,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),this.sizing=!1,this.sized=!0,this.build()};if(!t.naturalWidth||i){var o=document.createElement("img"),a=document.body||document.documentElement;this.sizingImage=o,o.onload=()=>{n(o.width,o.height),i||a.removeChild(o)},o.src=t.src,i||(o.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",a.appendChild(o))}else n(t.naturalWidth,t.naturalHeight)}stop(){var{image:t}=this;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}build(){if(this.sized){var{element:t,options:e,image:i}=this,n=t.parentNode,a=document.createElement("div");a.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var r=a.querySelector(".".concat(o,"-container")),s=r.querySelector(".".concat(o,"-canvas")),h=r.querySelector(".".concat(o,"-drag-box")),l=r.querySelector(".".concat(o,"-crop-box")),c=l.querySelector(".".concat(o,"-face"));this.container=n,this.cropper=r,this.canvas=s,this.dragBox=h,this.cropBox=l,this.viewBox=r.querySelector(".".concat(o,"-view-box")),this.face=c,s.appendChild(i),q(t,d),n.insertBefore(r,t.nextSibling),this.isImg||$(i,p),q(c,g),function(t,e,i){M(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(G(e)),i)}(c,u,"all"),this.initPreview(),this.render(),this.bind(),"function"==typeof this.options.onReady&&this.options.onReady()}}}O(lt.prototype,nt,ot,at,rt,st,ht);const ct=lt;var dt="undefined"!=typeof window,pt=dt?window:{},gt=!!dt&&"ontouchstart"in pt.document.documentElement,ut=/^img|canvas$/i,mt=/^data:image\/jpeg;base64,/,ft="image/jpeg",vt="doodle",wt="".concat(vt,"-hide"),bt="".concat(vt,"-hidden"),xt=gt?"touchstart":"mousedown",yt=gt?"touchmove":"mousemove",Dt=gt?"touchend touchcancel":"mouseup",Ct=(document.body.clientWidth||window.screen.availWidth)-10,Mt=Math.ceil(.01*Ct),St=Math.ceil(.03*Ct),Tt=Math.ceil(.04*Ct),Lt=Math.ceil(.05*Ct),Et=Math.ceil(.06*Ct),Wt=Math.ceil(.1*Ct);const Ot={initialAspectRatio:NaN,aspectRatio:NaN,outPutImageType:ft,outPutImageDefinition:1,tool:"pencil",toolColor:"#000",pencilSize:"L",maxScale:2,minScale:1,scale:1,stepScaleNumber:.02},Ht={render(){this.initContainer(),this.initCanvas(),this.initDoodleCanvas()},initContainer(){var{element:t,options:e,container:i,doodle:n}=this,o=i.getBoundingClientRect(),a={width:i.offsetWidth,height:i.offsetHeight,x:o.x,y:o.y};this.containerData=a,A(n,{width:a.width,height:a.height})},initCanvas(){var{containerData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,a=n/o,r=t.width,s=t.height;a>r/s?s=n>t.width?(r=t.width)/a:(r=n)/a:r=o>t.height?(s=t.height)*a:(s=o)*a;var h={aspectRatio:a,naturalWidth:n,naturalHeight:o,width:r*this.scale,height:s*this.scale};h.left=(t.width-h.width)/2,h.top=(t.height-h.height)/2,this.canvasData=h;var{canvas:l}=this;A(l,O({width:h.width,height:h.height},Y({translateX:h.left,translateY:h.top}))),O(this.imageData,{width:h.width,height:h.height,left:0,top:0}),this.renderImage()},renderImage(){var{canvasData:t,imageData:e}=this,i=e.naturalWidth*(t.width/t.naturalWidth),n=e.naturalHeight*(t.height/t.naturalHeight);this.imageData=O(e,{width:i,height:n,left:(t.width-i)/2,top:(t.height-n)/2}),A(this.image,O({width:e.width,height:e.height},Y(O({translateX:e.left,translateY:e.top},e))))},initDoodleCanvas(){var{canvas:t,canvasData:e}=this,i=document.createElement("canvas");i.width=e.width,i.height=e.height,t.appendChild(i);var n=i.getContext("2d");this.doodleContext=n,this.doodleCanvas=i,this.renderDoodleContext()},renderDoodleContext(){var{tool:t,toolColor:e,pencilSize:i}=this.options,{doodleContext:n}=this;if("pencil"===t)switch(n.globalCompositeOperation="source-over",n.strokeStyle=e,i){case"S":n.lineWidth=this.calcPencilSize(Mt);break;case"M":n.lineWidth=this.calcPencilSize(St);break;case"L":n.lineWidth=this.calcPencilSize(Tt);break;case"XL":n.lineWidth=this.calcPencilSize(Lt);break;case"XXL":n.lineWidth=this.calcPencilSize(Et)}else"rubber"===t&&(n.globalCompositeOperation="destination-out",n.strokeStyle="#fff",n.lineWidth=Wt);n.lineJoin="round"},calcPencilSize(t){return this.scale>1?t/this.scale:t*this.scale}},Rt={bind(){var{element:t,doodleCanvas:e}=this;V(e,xt,this.onDoodleStart=this.doodleStart.bind(this)),V(e,yt,this.onDoodleMove=this.doodleMove.bind(this)),V(e,Dt,this.onDoodleEnd=this.doodleEnd.bind(this))},unbind(){var{element:t,doodleCanvas:e}=this;_(e,xt,this.onDoodleStart),_(e,yt,this.onDoodleMove),_(e,Dt,this.onDoodleEnd)}},Bt={doodleStart(t){var{pointers:e,doublePointers:i,options:n}=this;if(t.targetTouches){if(1===t.targetTouches.length)e[0]=Z(t.targetTouches[0]);else if(2===t.targetTouches.length){var o=0;W(t.targetTouches,(t=>{i[o]=Z(t),o++}))}}else e[0]=Z(t);this.action=!0,t.preventDefault(),t.stopPropagation()},doodleMove(t){var{pointers:e,action:i,doublePointers:n,options:o}=this;if(i){if(t.targetTouches){if(1===t.targetTouches.length)O(e[0]||{},Z(t.targetTouches[0],!0)),this.change(t);else if(2===t.targetTouches.length){var a=0;W(t.targetTouches,(t=>{O(n[a]||{},Z(t,!0)),a++})),this.doubleFinger(t)}}else O(e[0]||{},Z(t,!0)),this.change(t);t.preventDefault(),t.stopPropagation()}},doodleEnd(t){var{pointers:e,action:i,doublePointers:n,options:o,canvas:a}=this;if("zoom"===o.tool&&(this.canvasData.left=a.getBoundingClientRect().left,this.canvasData.top=a.getBoundingClientRect().top),this.doubleFingerRange=0,t.targetTouches){var r=0;W(t.targetTouches,(t=>{delete e[r],delete n[r],r++}))}else delete e[0];i&&(Object.keys(e).length||(this.action=!1),t.preventDefault(),t.stopPropagation())}},kt={change(t){var{pointers:e,doodleContext:i,canvasData:n,containerData:o,options:a,canvas:r}=this,s=e[Object.keys(e)[0]],{startX:h,startY:l,endX:c,endY:d}=s;if("zoom"===a.tool){var p,g,u=n.width-o.width,m=n.height-o.height,f=c-h,v=d-l;return p=u>0?f<0?n.left+f<-u?-u:n.left+f:n.left+f>0?0:n.left+f:n.left,g=m>0?v<0?n.top+v<-m?-m:n.top+v:n.top+v>0?0:n.top+v:n.top,void A(r,O({width:n.width,height:n.height},Y({translateX:p,translateY:g})))}h-=n.left+o.x,l-=n.top+o.y,c-=n.left+o.x,d-=n.top+o.y,this.doodleData.push({pointer:{startX:h,startY:l,endX:c,endY:d,scale:this.scale},tool:a.tool,toolColor:a.toolColor,pencilSize:this.doodleContext.lineWidth}),h/=this.scale,l/=this.scale,c/=this.scale,d/=this.scale,i.beginPath(),i.moveTo(h,l),i.lineTo(c,d),i.closePath(),i.stroke(),W(e,(t=>{t&&(t.startX=t.endX,t.startY=t.endY)}))},doubleFinger(){var{doublePointers:t,doubleFingerRange:e}=this,i=t[0],n=t[1],o=Math.abs(n.endY-i.endY);e<o?this.enlarge():this.reduce(),this.doubleFingerRange=o}},It={pencil(){this.options.tool="pencil",this.renderDoodleContext()},rubber(){this.options.tool="rubber",this.renderDoodleContext()},zoom(){this.options.tool="zoom"},pencilColor(t){this.options.toolColor=t,this.renderDoodleContext()},pencilSize(t){this.options.pencilSize=t,this.renderDoodleContext()},getDoodleCanvas(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{canvasData:e,doodleData:i,containerData:n}=this;if(!window.HTMLCanvasElement||0===i.length)return{toDataURL:()=>null,toBlob:()=>null};1!==this.scale&&(this.scale=1,this.reDraw()),e.top=et(e.top);var o=it(this.image,this.imageData,e,t),a=o.getContext("2d"),r=document.createElement("canvas");r.width=et(o.width),r.height=et(o.height);var s=r.getContext("2d"),h=e.naturalWidth/n.width;return W(i,((t,e)=>{"pencil"===t.tool?(s.globalCompositeOperation="source-over",s.strokeStyle=t.toolColor,s.lineWidth=t.pencilSize*h):"rubber"===t.tool&&(s.globalCompositeOperation="destination-out",s.strokeStyle="#ffffff",s.lineWidth=Wt*h),s.lineJoin="round";var{startX:i,startY:n,endX:o,endY:a,scale:r}=t.pointer;i=i/r*h,n=n/r*h,o=o/r*h,a=a/r*h,s.beginPath(),s.moveTo(i,n),s.lineTo(o,a),s.closePath(),s.stroke()})),a.drawImage(r,0,0,o.width,o.height),o},toDataURL(){var{outPutImageType:t,outPutImageDefinition:e}=this.options;return this.getDoodleCanvas().toDataURL(t,e)},toBlob(t){var{outPutImageType:e,outPutImageDefinition:i}=this.options;this.getDoodleCanvas().toBlob(t,e,i)},destroy(){var{element:t}=this;if(!t.doodle)return this;t.doodle=void 0,t.src=this.originalUrl,this.doodleData=[],this.unbind(),this.doodle.parentNode.removeChild(this.doodle),$(this.element,bt)},enlarge(){this.options.tool="zoom",this.scale+=this.stepScaleNumber,this.scale=this.scale>this.maxScale?this.maxScale:this.scale,this.reDraw()},reduce(){this.options.tool="zoom",this.scale-=this.stepScaleNumber,this.scale=this.scale<this.minScale?this.minScale:this.scale,this.reDraw()},reDraw(){this.initContainer(),this.initCanvas(),this.pencilSize(this.options.pencilSize)}};i(511);class Nt{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!ut.test(t.tagName))throw new Error("主元素必须为<img> 或者 <canvas> 元素.");this.element=t,this.options=O({},Ot,T(e)&&e),this.sized=!1,this.pointers=[],this.doodleData=[],this.doublePointers=[],this.doubleFingerRange=0,this.scale=this.options.scale,this.maxScale=this.options.maxScale,this.minScale=this.options.minScale,this.stepScaleNumber=this.options.stepScaleNumber,this.toolChange=this.options.toolChange;var i=this.options.tool;Object.defineProperty(this.options,"tool",{get:()=>i,set(t){this.toolChange&&this.toolChange(t),i=t}}),this.init()}init(){var t,{element:e}=this,i=e.tagName.toLowerCase();if(!e.doodle){if(e.doodle=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}load(t){if(t){this.url=t,this.imageData={};var{element:e,options:i}=this;if(mt.test(t))this.read(B(t));else{var n=new XMLHttpRequest,o=this.clone.bind(this);this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=()=>{},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.xhr=null},i.checkCrossOrigin&&N(t)&&e.crossOrigin&&(t=X(t)),n.open("GET",t),n.responseType="arraybuffer",n.withCredentials="use-credentials"===e.crossOrigin,n.send()}}}read(t){var{imageData:e}=this,i=z(t),n=0,o=1,a=1;i>1&&(this.url=U(t,ft),({rotate:n,scaleX:o,scaleY:a}=P(i))),e.rotate=n,e.scaleX=o,e.scaleY=a,this.clone()}clone(){var t,e,{element:i,url:n}=this;this.options.checkCrossOrigin&&N(n)&&(({crossOrigin:t}=i),t||(t="anonymous"),e=X(n)),this.crossOrigin=t,this.crossOriginUrl=e;var o=document.createElement("img");t&&(o.crossOrigin=t),o.src=e||n,this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),q(o,wt),i.parentNode.insertBefore(o,i.nextSibling)}start(){var t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var e=pt.navigator&&/^(?:.(?!chrome|android))*safari/i.test(pt.navigator.userAgent),i=(t,e)=>{O(this.imageData,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),this.sizing=!1,this.sized=!0,this.build()};if(!t.naturalWidth||e){var n=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=n,n.onload=()=>{i(n.width,n.height),e||o.removeChild(n)},n.src=t.src,e||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(n))}else i(t.naturalWidth,t.naturalHeight)}stop(){var{image:t}=this;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}build(){if(this.sized){var{element:t,options:e,image:i}=this,n=t.parentNode,o=document.createElement("div");o.innerHTML='<div class="doodle-container" touch-action="none"><div class="doodle-wrap-box"><div class="doodle-canvas"></div></div></div>';var a=o.querySelector(".".concat(vt,"-container")),r=a.querySelector(".".concat(vt,"-canvas")),s=o.querySelector(".".concat(vt,"-wrap-box"));this.container=n,this.doodle=a,this.canvas=r,this.doodleWrapBox=s,r.appendChild(i),q(t,bt),n.insertBefore(a,t.nextSibling),this.render(),this.bind()}}}O(Nt.prototype,Ht,Rt,Bt,kt,It);const Ut=Nt;var zt="undefined"!=typeof window?window:{},Pt=/^img|canvas$/i,Xt=/^data:image\/jpeg;base64,/,Yt="image/jpeg",jt="discoloration",At="".concat(jt,"-hide"),qt="".concat(jt,"-hidden");const $t={outPutImageType:Yt,outPutImageDefinition:1},Ft={render(){this.initContainer(),this.initCanvas()},initContainer(){var{container:t,discoloration:e}=this,i={width:t.offsetWidth,height:t.offsetHeight};this.containerData=i,A(e,{width:i.width,height:i.height})},initCanvas(){var{containerData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,a=n/o,r=t.width,s=t.height;a>r/s?s=n>t.width?(r=t.width)/a:(r=n)/a:r=o>t.height?(s=t.height)*a:(s=o)*a;var h={aspectRatio:a,naturalWidth:n,naturalHeight:o,width:r,height:s};h.left=(t.width-r)/2,h.top=(t.height-s)/2,this.canvasData=h;var{canvas:l}=this;A(l,O({width:h.width,height:h.height},Y({translateX:h.left,translateY:h.top}))),O(this.imageData,{width:h.width,height:h.height,left:0,top:0}),this.renderImage()},renderImage(){var{canvasData:t,imageData:e}=this,i=e.naturalWidth*(t.width/t.naturalWidth),n=e.naturalHeight*(t.height/t.naturalHeight);this.imageData=O(e,{width:i,height:n,left:(t.width-i)/2,top:(t.height-n)/2}),A(this.image,O({width:e.width,height:e.height},Y(O({translateX:e.left,translateY:e.top},e))))}},Gt={getDiscoloration(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!window.HTMLCanvasElement)return null;for(var{canvasData:e}=this,i=it(this.image,this.imageData,e,t),n=i.getContext("2d"),o=n.getImageData(0,0,i.width,i.height),a=o.data,r=0,s=a.length;r<s;r+=4){var h=(a[r]+a[r+1]+a[r+2])/3;a[r]=h,a[r+1]=h,a[r+2]=h}return n.putImageData(o,0,0),i},toDataURL(){var{outPutImageType:t,outPutImageDefinition:e}=this.options;return this.getDiscoloration().toDataURL(t,e)},toBlob(t){var{outPutImageType:e,outPutImageDefinition:i}=this.options;this.getDiscoloration().toBlob(t,e,i)},destroy(){var{element:t}=this;if(!t.discoloration)return this;t.discoloration=void 0,t.src=this.originalUrl,this.discoloration.parentNode.removeChild(this.discoloration),$(this.element,qt)}};i(89);class Jt{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!Pt.test(t.tagName))throw new Error("主元素必须为<img> 或者 <canvas> 元素.");this.element=t,this.options=O({},$t,T(e)&&e),this.sized=!1,this.init()}init(){var t,{element:e}=this,i=e.tagName.toLowerCase();if(!e.discoloration){if(e.discoloration=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}load(t){if(t){this.url=t,this.imageData={};var{element:e,options:i}=this;if(Xt.test(t))this.read(B(t));else{var n=new XMLHttpRequest,o=this.clone.bind(this);this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=()=>{},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.xhr=null},i.checkCrossOrigin&&N(t)&&e.crossOrigin&&(t=X(t)),n.open("GET",t),n.responseType="arraybuffer",n.withCredentials="use-credentials"===e.crossOrigin,n.send()}}}read(t){var{imageData:e}=this,i=z(t),n=0,o=1,a=1;i>1&&(this.url=U(t,Yt),({rotate:n,scaleX:o,scaleY:a}=P(i))),e.rotate=n,e.scaleX=o,e.scaleY=a,this.clone()}clone(){var t,e,{element:i,url:n}=this;this.options.checkCrossOrigin&&N(n)&&(({crossOrigin:t}=i),t||(t="anonymous"),e=X(n)),this.crossOrigin=t,this.crossOriginUrl=e;var o=document.createElement("img");t&&(o.crossOrigin=t),o.src=e||n,this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),q(o,At),i.parentNode.insertBefore(o,i.nextSibling)}start(){var t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var e=zt.navigator&&/^(?:.(?!chrome|android))*safari/i.test(zt.navigator.userAgent),i=(t,e)=>{O(this.imageData,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),this.sizing=!1,this.sized=!0,this.build()};if(!t.naturalWidth||e){var n=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=n,n.onload=()=>{i(n.width,n.height),e||o.removeChild(n)},n.src=t.src,e||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(n))}else i(t.naturalWidth,t.naturalHeight)}stop(){var{image:t}=this;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}build(){if(this.sized){var{element:t,options:e,image:i}=this,n=t.parentNode,o=document.createElement("div");o.innerHTML='<div class="discoloration-container" touch-action="none"><div class="discoloration-wrap-box"><div class="discoloration-canvas"></div></div></div>';var a=o.querySelector(".".concat(jt,"-container")),r=a.querySelector(".".concat(jt,"-canvas"));this.container=n,this.discoloration=a,this.canvas=r,r.appendChild(i),q(t,qt),n.insertBefore(a,t.nextSibling),this.render()}}}O(Jt.prototype,Ft,Gt);const Qt=Jt})(),n})()}));