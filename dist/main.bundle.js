!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(self,(function(){return(()=>{var t={508:(t,e,i)=>{(e=i(645)(!1)).push([t.id,".cropper-container {\n  direction: ltr;\n  font-size: 0;\n  line-height: 0;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n  padding-left: 5px;\n}\n.cropper-container img {\n  display: block;\n  height: 100%;\n  image-orientation: 0deg;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n.cropper-wrap-box,\n.cropper-canvas,\n.cropper-drag-box,\n.cropper-crop-box,\n.cropper-modal {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.cropper-drag-box {\n  margin-top: -5px;\n  margin-right: -5px;\n  margin-bottom: -5px;\n}\n.cropper-modal {\n  background-color: #000;\n  opacity: 0.5;\n}\n.cropper-hidden {\n  display: none !important;\n}\n.cropper-hide {\n  display: block;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.cropper-crop {\n  cursor: crosshair;\n}\n.cropper-wrap-box {\n  bottom: 0;\n  left: 5px;\n  position: absolute;\n  right: 0;\n  top: 0;\n  overflow: hidden;\n}\n.cropper-crop-box {\n  bottom: 0;\n  left: 5px;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.cropper-crop-box .cropper-view-box {\n  display: block;\n  height: 100%;\n  outline-color: #fff;\n  outline: 2px solid #fff;\n  overflow: hidden;\n  width: 100%;\n}\n.cropper-crop-box .cropper-view-box > img {\n  max-width: inherit;\n}\n.cropper-crop-box .cropper-dashed {\n  border: 0 solid #fff;\n  display: block;\n  opacity: 0.7;\n  position: absolute;\n}\n.cropper-crop-box .cropper-dashed.dashed-h {\n  border-bottom-width: 2px;\n  border-top-width: 2px;\n  height: 33.33333%;\n  left: 0;\n  top: 33.33333%;\n  width: 100%;\n}\n.cropper-crop-box .cropper-dashed.dashed-v {\n  border-left-width: 2px;\n  border-right-width: 2px;\n  height: 100%;\n  left: 33.33333%;\n  top: 0;\n  width: 33.33333%;\n}\n.cropper-crop-box .cropper-move {\n  cursor: move;\n}\n.cropper-crop-box .cropper-face {\n  background-color: #fff;\n  left: 0;\n  top: 0;\n  display: block;\n  height: 100%;\n  opacity: 0.1;\n  position: absolute;\n  width: 100%;\n}\n.cropper-crop-box .cropper-line {\n  display: block;\n  height: 100%;\n  opacity: 0.1;\n  position: absolute;\n}\n.cropper-crop-box .cropper-line.line-e {\n  cursor: ew-resize;\n  right: -3px;\n  top: 0;\n  width: 3px;\n  padding-left: 0px;\n}\n.cropper-crop-box .cropper-line.line-n {\n  cursor: ns-resize;\n  height: 3px;\n  left: 0;\n  top: -3px;\n  width: 100%;\n  padding-bottom: 0px;\n}\n.cropper-crop-box .cropper-line.line-w {\n  cursor: ew-resize;\n  left: -3px;\n  top: 0;\n  width: 3px;\n  padding-right: 0px;\n}\n.cropper-crop-box .cropper-line.line-s {\n  bottom: -3px;\n  cursor: ns-resize;\n  height: 3px;\n  left: 0;\n  width: 100%;\n  padding-top: 0px;\n}\n.cropper-crop-box .cropper-point {\n  display: block;\n  position: absolute;\n  background-color: inherit;\n  text-transform: none;\n}\n.cropper-crop-box .cropper-point.point-ne {\n  border-top: 5px solid #fff;\n  border-right: 5px solid #fff;\n  width: 15px;\n  top: -5px;\n  height: 15px;\n  right: -5px;\n}\n.cropper-crop-box .cropper-point.point-nw {\n  border-top: 5px solid #fff;\n  border-left: 5px solid #fff;\n  width: 15px;\n  top: -5px;\n  height: 15px;\n  left: -5px;\n}\n.cropper-crop-box .cropper-point.point-sw {\n  border-bottom: 5px solid #fff;\n  border-left: 5px solid #fff;\n  width: 15px;\n  bottom: -5px;\n  height: 15px;\n  left: -5px;\n}\n.cropper-crop-box .cropper-point.point-se {\n  border-bottom: 5px solid #fff;\n  border-right: 5px solid #fff;\n  width: 15px;\n  bottom: -5px;\n  height: 15px;\n  right: -5px;\n}\n",""]),t.exports=e},164:(t,e,i)=>{(e=i(645)(!1)).push([t.id,".discoloration-container {\n  direction: ltr;\n  font-size: 0;\n  line-height: 0;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n}\n.discoloration-container img,\n.discoloration-container canvas {\n  display: block;\n  height: 100%;\n  image-orientation: 0deg;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n.discoloration-container img {\n  filter: grayscale(1);\n}\n.discoloration-container canvas {\n  z-index: 1;\n  position: absolute;\n}\n.discoloration-wrap-box,\n.discoloration-canvas {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.discoloration-hide {\n  display: block;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.discoloration-hidden {\n  display: none !important;\n}\n",""]),t.exports=e},480:(t,e,i)=>{(e=i(645)(!1)).push([t.id,".doodle-container {\n  direction: ltr;\n  font-size: 0;\n  line-height: 0;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n}\n.doodle-container img,\n.doodle-container canvas {\n  display: block;\n  height: 100%;\n  image-orientation: 0deg;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n.doodle-container canvas {\n  z-index: 1;\n  position: absolute;\n}\n.doodle-wrap-box,\n.doodle-canvas {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.doodle-hide {\n  display: block;\n  height: 0;\n  position: absolute;\n  width: 0;\n}\n.doodle-hidden {\n  display: none !important;\n}\n",""]),t.exports=e},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i,n,o,a=t[1]||"",r=t[3];if(!r)return a;if(e&&"function"==typeof btoa){var s=(i=r,n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(o," */")),h=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[a].concat(h).concat([s]).join("\n")}return[a].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(n)for(var a=0;a<this.length;a++){var r=this[a][0];null!=r&&(o[r]=!0)}for(var s=0;s<t.length;s++){var h=[].concat(t[s]);n&&o[h[0]]||(i&&(h[2]?h[2]="".concat(i," and ").concat(h[2]):h[2]=i),e.push(h))}},e}},676:(t,e,i)=>{var n=i(508);"string"==typeof n&&(n=[[t.id,n,""]]);i(723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(t.exports=n.locals)},89:(t,e,i)=>{var n=i(164);"string"==typeof n&&(n=[[t.id,n,""]]);i(723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(t.exports=n.locals)},511:(t,e,i)=>{var n=i(480);"string"==typeof n&&(n=[[t.id,n,""]]);i(723)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(t.exports=n.locals)},723:(t,e,i)=>{var n,o,a={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),s=function(t,e){return e?e.querySelector(t):document.querySelector(t)},h=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=s.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),l=null,c=0,d=[],p=i(947);function g(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=a[n.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](n.parts[r]);for(;r<n.parts.length;r++)o.parts.push(b(n.parts[r],e))}else{var s=[];for(r=0;r<n.parts.length;r++)s.push(b(n.parts[r],e));a[n.id]={id:n.id,refs:1,parts:s}}}}function u(t,e){for(var i=[],n={},o=0;o<t.length;o++){var a=t[o],r=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[r]?n[r].parts.push(s):i.push(n[r]={id:r,parts:[s]})}return i}function m(t,e){var i=h(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=d[d.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),d.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=h(t.insertAt.before,i);i.insertBefore(e,o)}}function f(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=d.indexOf(t);e>=0&&d.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=i.nc;n&&(t.attrs.nonce=n)}return w(e,t.attrs),m(t,e),e}function w(t,e){Object.keys(e).forEach((function(i){t.setAttribute(i,e[i])}))}function b(t,e){var i,n,o,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var r=c++;i=l||(l=v(e)),n=D.bind(null,i,r,!1),o=D.bind(null,i,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",w(e,t.attrs),m(t,e),e}(e),n=M.bind(null,i,e),o=function(){f(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(e),n=C.bind(null,i),o=function(){f(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=r()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=u(t,e);return g(i,e),function(t){for(var n=[],o=0;o<i.length;o++){var r=i[o];(s=a[r.id]).refs--,n.push(s)}for(t&&g(u(t,e),e),o=0;o<n.length;o++){var s;if(0===(s=n[o]).refs){for(var h=0;h<s.parts.length;h++)s.parts[h]();delete a[s.id]}}}};var x,y=(x=[],function(t,e){return x[t]=e,x.filter(Boolean).join("\n")});function D(t,e,i,n){var o=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var a=document.createTextNode(o),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(a,r[e]):t.appendChild(a)}}function C(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function M(t,e,i){var n=i.css,o=i.sourceMap,a=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||a)&&(n=p(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}},947:t=>{t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var o,a=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={id:n,exports:{}};return t[n](a,a.exports,i),a.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";i.r(n),i.d(n,{Cropper:()=>Ct,DisColorAtion:()=>he,Doodle:()=>_t,Utilities:()=>t});var t={};i.r(t),i.d(t,{IS_BROWSER:()=>x,WINDOW:()=>y,addClass:()=>Q,addListener:()=>rt,addTimestamp:()=>q,arrayBufferToDataURL:()=>j,assign:()=>B,autoRegulateImage:()=>gt,dataURLToArrayBuffer:()=>k,forEach:()=>H,getAdjustedSizes:()=>ht,getData:()=>tt,getPointer:()=>st,getRotatedSizes:()=>lt,getSourceCanvas:()=>pt,getStringFromCharCode:()=>U,getTransforms:()=>$,hasClass:()=>J,isCrossOriginURL:()=>X,isFunction:()=>R,isNaN:()=>D,isNumber:()=>C,isObject:()=>T,isPlainObject:()=>W,isPositiveNumber:()=>M,isUndefined:()=>S,normalizeDecimalNumber:()=>dt,parseOrientation:()=>A,removeClass:()=>_,removeData:()=>it,removeListener:()=>at,resetAndGetOrientation:()=>Y,setData:()=>et,setStyle:()=>G,toArray:()=>E,toParamCase:()=>K,toggleClass:()=>V});var e="undefined"!=typeof window,o=e?window:{},a="cropper",r=!!e&&"ontouchstart"in o.document.documentElement,s=!!e&&"PointerEvent"in o,h=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,l=/^img|canvas$/i,c=/^data:image\/jpeg;base64,/,d="image/jpeg",p=("".concat(a,"-crop"),"".concat(a,"-disabled"),"".concat(a,"-hidden")),g="".concat(a,"-hide"),u=("".concat(a,"-invisible"),"".concat(a,"-modal"),"".concat(a,"-move")),m="".concat(a,"Action"),f=("".concat(a,"Preview"),s?"pointerdown":r?"touchstart":"mousedown"),v=s?"pointermove":r?"touchmove":"mousemove",w=s?"pointerup pointercancel":r?"touchend touchcancel":"mouseup";const b={cropModel:"freedom",initialAspectRatio:NaN,aspectRatio:NaN,cropMinW:50,cropMinH:50,outPutImageType:d,outPutImageDefinition:1,initCropBoxWidth:NaN,initCropBoxHeight:100,onReady:null};var x="undefined"!=typeof window,y=x?window:{},D=Number.isNaN||y.isNaN;function C(t){return"number"==typeof t&&!D(t)}var M=t=>t>0&&t<1/0;function S(t){return void 0===t}function T(t){return"object"==typeof t&&null!==t}var{hasOwnProperty:L}=Object.prototype;function W(t){if(!T(t))return!1;try{var{constructor:e}=t,{prototype:i}=e;return e&&i&&L.call(i,"isPrototypeOf")}catch(t){return!1}}function R(t){return"function"==typeof t}var{slice:O}=Array.prototype;function E(t){return Array.from?Array.from(t):O.call(t)}function H(t,e){return t&&R(e)&&(Array.isArray(t)||C(t.length)?E(t).forEach(((i,n)=>{e.call(t,i,n,t)})):T(t)&&Object.keys(t).forEach((i=>{e.call(t,t[i],i,t)}))),t}var B=Object.assign||function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return T(t)&&i.length>0&&i.forEach((e=>{T(e)&&Object.keys(e).forEach((i=>{t[i]=e[i]}))})),t},{fromCharCode:N}=String;function U(t,e,i){var n="";i+=e;for(var o=e;o<i;o+=1)n+=N(t.getUint8(o));return n}var I=/^data:.*,/;function k(t){var e=t.replace(I,""),i=atob(e),n=new ArrayBuffer(i.length),o=new Uint8Array(n);return H(o,((t,e)=>{o[e]=i.charCodeAt(e)})),n}var{location:P}=y,z=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function X(t){var e=t.match(z);return null!==e&&(e[1]!==P.protocol||e[2]!==P.hostname||e[3]!==P.port)}function j(t,e){for(var i=[],n=new Uint8Array(t);n.length>0;)i.push(N.apply(null,E(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(i.join("")))}function Y(t){var e,i=new DataView(t);try{var n,o,a;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var r=i.byteLength,s=2;s+1<r;){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){o=s;break}s+=1}if(o){var h=o+10;if("Exif"===U(i,o+4,4)){var l=i.getUint16(h);if(((n=18761===l)||19789===l)&&42===i.getUint16(h+2,n)){var c=i.getUint32(h+4,n);c>=8&&(a=h+c)}}}if(a){var d,p,g=i.getUint16(a,n);for(p=0;p<g;p+=1)if(d=a+12*p+2,274===i.getUint16(d,n)){d+=8,e=i.getUint16(d,n),i.setUint16(d,1,n);break}}}catch(t){e=1}return e}function A(t){var e=0,i=1,n=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:n=-1;break;case 5:e=90,n=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90}return{rotate:e,scaleX:i,scaleY:n}}function q(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function $(t){var{rotate:e,scaleX:i,scaleY:n,translateX:o,translateY:a}=t,r=[];C(o)&&0!==o&&r.push("translateX(".concat(o,"px)")),C(a)&&0!==a&&r.push("translateY(".concat(a,"px)")),C(e)&&0!==e&&r.push("rotate(".concat(e,"deg)")),C(i)&&1!==i&&r.push("scaleX(".concat(i,")")),C(n)&&1!==n&&r.push("scaleY(".concat(n,")"));var s=r.length?r.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}var F=/^width|height|left|top|marginLeft|marginTop$/;function G(t,e){var{style:i}=t;H(e,((t,e)=>{F.test(e)&&C(t)&&(t="".concat(t,"px")),i[e]=t}))}function J(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function Q(t,e){if(e)if(C(t.length))H(t,(t=>{Q(t,e)}));else if(t.classList)t.classList.add(e);else{var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function _(t,e){e&&(C(t.length)?H(t,(t=>{_(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function V(t,e,i){e&&(C(t.length)?H(t,(t=>{V(t,e,i)})):i?Q(t,e):_(t,e))}var Z=/([a-z\d])([A-Z])/g;function K(t){return t.replace(Z,"$1-$2").toLowerCase()}function tt(t,e){return T(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(K(e)))}function et(t,e,i){T(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(K(e)),i)}function it(t,e){if(T(t[e]))try{delete t[e]}catch(i){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(i){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(K(e)))}var nt=/\s\s*/,ot=(()=>{var t=!1;if(x){var e=!1,i=()=>{},n=Object.defineProperty({},"once",{get:()=>(t=!0,e),set(t){e=t}});y.addEventListener("test",i,n),y.removeEventListener("test",i,n)}return t})();function at(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i;e.trim().split(nt).forEach((e=>{if(!ot){var{listeners:a}=t;a&&a[e]&&a[e][i]&&(o=a[e][i],delete a[e][i],0===Object.keys(a[e]).length&&delete a[e],0===Object.keys(a).length&&delete t.listeners)}t.removeEventListener(e,o,n)}))}function rt(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i;e.trim().split(nt).forEach((e=>{if(n.once&&!ot){var{listeners:a={}}=t;o=function(){delete a[e][i],t.removeEventListener(e,o,n);for(var r=arguments.length,s=new Array(r),h=0;h<r;h++)s[h]=arguments[h];i.apply(t,s)},a[e]||(a[e]={}),a[e][i]&&t.removeEventListener(e,a[e][i],n),a[e][i]=o,t.listeners=a}t.addEventListener(e,o,n)}))}function st(t,e){var{pageX:i,pageY:n}=t,o={endX:i,endY:n};return e?o:B({startX:i,startY:n},o)}function ht(t){var{aspectRatio:e,height:i,width:n}=t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",a=M(n),r=M(i);if(a&&r){var s=i*e;"contain"===o&&s>n||"cover"===o&&s<n?i=n/e:n=i*e}else a?i=n/e:r&&(n=i*e);return{width:n,height:i}}function lt(t){var{width:e,height:i,degree:n}=t;if(90==(n=Math.abs(n)%180))return{width:i,height:e};var o=n%90*Math.PI/180,a=Math.sin(o),r=Math.cos(o),s=e*r+i*a,h=e*a+i*r;return n>90?{width:h,height:s}:{width:s,height:h}}var ct=/\.\d*(?:0|9){12}\d*$/;function dt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return ct.test(t)?Math.round(t*e)/e:t}function pt(t,e,i,n){var{aspectRatio:o,naturalWidth:a,naturalHeight:r,rotate:s=0,scaleX:h=1,scaleY:l=1}=e,{aspectRatio:c,naturalWidth:d,naturalHeight:p}=i,{fillColor:g="transparent",imageSmoothingEnabled:u=!0,imageSmoothingQuality:m="low",maxWidth:f=1/0,maxHeight:v=1/0,minWidth:w=0,minHeight:b=0}=n;if(Math.abs(s)%180==90){var x=a,y=d;a=r,r=x,d=p,p=y}var D=document.createElement("canvas"),C=D.getContext("2d"),M=ht({aspectRatio:c,width:f,height:v}),S=ht({aspectRatio:c,width:w,height:b},"cover"),T=Math.min(M.width,Math.max(S.width,d)),L=Math.min(M.height,Math.max(S.height,p)),W=ht({aspectRatio:o,width:f,height:v}),R=ht({aspectRatio:o,width:w,height:b},"cover"),O=Math.min(W.width,Math.max(R.width,a)),E=Math.min(W.height,Math.max(R.height,r)),H=[-O/2,-E/2,O,E];return D.width=dt(T),D.height=dt(L),C.fillStyle=g,C.fillRect(0,0,T,L),C.save(),C.translate(T/2,L/2),C.rotate(s*Math.PI/180),C.scale(h,l),C.imageSmoothingEnabled=u,C.imageSmoothingQuality=m,C.drawImage(t,...H.map((t=>Math.floor(dt(t))))),C.restore(),D}function gt(t,e,i){if(t)if(/^data:image\/jpeg;base64,/.test(t))ut(k(t),e,i);else{var n=new XMLHttpRequest;n.onabort=()=>{},n.onerror=()=>{},n.ontimeout=()=>{},n.onprogress=()=>{},n.onload=()=>{ut(n.response,e,i)},n.onloadend=()=>{},n.open("GET",t),n.responseType="arraybuffer",n.withCredentials=!0,n.send()}}function ut(t,e,i){var n,o="image/jpeg",a=Y(t),r=0;if(!(a>1))return!!i&&i(mt(t,o));n=j(t,o),({rotate:r}=A(a));var s,h,l=document.createElement("img");l.src=n,l.onload=t=>{var n=t.currentTarget.height,o=t.currentTarget.width;h={naturalWidth:o,naturalHeight:n};var a=Math.abs(r)%180==90,c=a?n/o:o/n;s=a?{naturalWidth:n,naturalHeight:o,rotate:r,aspectRatio:c}:{naturalWidth:o,naturalHeight:n,rotate:r,aspectRatio:c},"blob"===e?i&&pt(l,s,h,{}).toBlob(i):i&&i(pt(l,s,h,{}).toDataURL())}}var mt=function(t,e){return new Blob([t],{type:e})};const ft={render(){this.initContainer(),this.initCanvas(),this.initCropBox()},initContainer(){var{element:t,options:e,container:i,cropper:n}=this,o={width:i.offsetWidth-10,height:i.offsetHeight-10};this.containerData=o,G(n,{width:o.width,height:o.height})},initCanvas(){var{containerData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,a=n/o,r=t.width,s=t.height;a>r/s?s=n>t.width?(r=t.width)/a:(r=n)/a:r=o>t.height?(s=t.height)*a:(s=o)*a;var h={aspectRatio:a,naturalWidth:n,naturalHeight:o,width:r,height:s};h.left=(t.width-r)/2,h.top=(t.height-s)/2,this.canvasData=h;var{canvas:l}=this;G(l,B({width:h.width,height:h.height},$({translateX:h.left,translateY:h.top}))),B(this.imageData,{width:h.width,height:h.height,left:0,top:0}),this.renderImage()},renderCanvas(t,e){var{canvasData:i,imageData:n,containerData:o}=this;if(e){var a,r,{width:s,height:h}=lt({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),l=s/h;o.width/o.height<l?r=(a=o.width-10)/l:a=(r=o.height-10)*l,i.left-=(a-i.width)/2,i.top-=(r-i.height)/2,i.width=a,i.height=r,i.aspectRatio=s/h,i.naturalWidth=s,i.naturalHeight=h,this.canvasData=i}G(this.canvas,B({width:i.width,height:i.height},$({translateX:i.left,translateY:i.top}))),this.limitCropBox(),this.renderImage(t)},renderImage(t){var{canvasData:e,imageData:i}=this,n=Math.abs(i.rotate)%180==90,o=i.naturalWidth,a=i.naturalHeight;i.naturalWidth>e.width&&(n?(o=e.height,a=i.naturalWidth*(e.height/i.naturalHeight)):(o=e.width,a=i.naturalHeight*(e.width/i.naturalWidth))),this.imageData=B(i,{width:o,height:a,left:(e.width-o)/2,top:(e.height-a)/2}),G(this.image,B({width:i.width,height:i.height},$(B({translateX:i.left,translateY:i.top},i)))),t&&this.output()},initDragBox(){var{dragBox:t}=this;Q(t,"cropper-crop"),Q(t,"cropper-modal")},initCropBox(){this.initDragBox();var{options:t,cropBox:e,canvasData:i,imageData:n}=this,o={width:t.initCropBoxWidth||i.width,height:(t.initCropBoxHeight<i.height?t.initCropBoxHeight:i.height)||i.height,top:i.top,left:i.left};o.top+=(i.height-o.height)/2,o.left+=(i.width-o.width)/2,"freedom"===t.cropModel&&G(e,B({width:o.width,height:o.height},$({translateX:o.left,translateY:o.top})));var a=i.left+i.width,r=i.top+i.height;this.cropBoxData=B(o,{minWidth:t.cropMinW,minHeight:t.cropMinH},{maxWidth:i.width,maxHeight:i.height,minLeft:i.left,minTop:i.top,maxLeft:a,maxTop:r}),this.output()},limitCropBox(){var{cropBoxData:t,canvasData:e}=this;B(t,{minWidth:b.cropMinW,minHeight:b.cropMinH},{maxWidth:e.width,maxHeight:e.height,minLeft:e.left,minTop:e.top,maxLeft:e.left+e.width,maxTop:e.top+e.height}),t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),t.left=Math.min(Math.max(t.left,t.minLeft),t.maxLeft-t.width),t.top=Math.min(Math.max(t.top,t.minTop),t.maxTop-t.height),t.oldLeft=t.left,t.oldTop=t.top,this.cropBoxData=t,G(this.cropBox,B({width:t.width,height:t.height},$({translateX:t.left,translateY:t.top})))},renderCropBox(){var{cropBoxData:t}=this;(t.width>t.maxWidth||t.width<t.minWidth)&&void 0!==t.oldLeft&&(t.left=t.oldLeft),(t.height>t.maxHeight||t.height<t.minHeight)&&void 0!==t.oldTop&&(t.top=t.oldTop),t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),t.left=Math.min(Math.max(t.left,t.minLeft),t.maxLeft),t.top=Math.min(Math.max(t.top,t.minTop),t.maxTop),t.oldLeft=t.left,t.oldTop=t.top,G(this.cropBox,B({width:t.width,height:t.height},$({translateX:t.left,translateY:t.top}))),this.output()},output(){this.preview()}},vt={initPreview(){var{crossOrigin:t}=this,e=t?this.crossOriginUrl:this.url,i=document.createElement("img");t&&(i.crossOrigin=t),i.src=e,this.viewBox.appendChild(i),this.viewBoxImage=i},preview(){var{canvasData:t,cropBoxData:e,imageData:i}=this,n=i.naturalWidth*(t.width/t.naturalWidth),o=i.naturalHeight*(t.height/t.naturalHeight),a=e.left-t.left-(C(i.left)?i.left:0),r=e.top-t.top-(C(i.top)?i.top:0);G(this.viewBoxImage,B({width:n,height:o},$(B({translateX:-a,translateY:-r},i))))}},wt={bind(){var{element:t}=this;rt(t.ownerDocument,f,this.onCropStart=this.cropStart.bind(this)),rt(t.ownerDocument,v,this.onCropMove=this.cropMove.bind(this)),rt(t.ownerDocument,w,this.onCropEnd=this.cropEnd.bind(this))},unbind(){var{element:t}=this;at(t.ownerDocument,f,this.onCropStart),at(t.ownerDocument,v,this.onCropMove),at(t.ownerDocument,w,this.onCropEnd)}},bt={cropStart(t){var e,{pointers:i}=this;t.changedTouches?H(t.changedTouches,(t=>{i[0]=st(t)})):i[0]=st(t),e=tt(t.target,m),h.test(e)&&(t.preventDefault(),t.stopPropagation(),this.action=e)},cropMove(t){this.startEventTimer=Date.now();var{action:e}=this;if(e){var{pointers:i}=this;t.preventDefault(),t.stopPropagation(),t.changedTouches?H(t.changedTouches,(t=>{B(i[0]||{},st(t,!0))})):B(i[0]||{},st(t,!0)),this.change(t)}},cropEnd(t){var{action:e,pointers:i}=this;t.changedTouches?H(t.changedTouches,(t=>{delete i[0]})):delete i[0],e&&(Object.keys(i).length||(this.action=""),t.preventDefault(),t.stopPropagation())}},xt={change(t){var{cropBoxData:e,pointers:i}=this,{action:n}=this,{left:o,top:a,width:r,height:s,minLeft:h,minTop:l,maxLeft:c,maxTop:d}=e,p=!0,g=i[Object.keys(i)[0]],u=g.endX-g.startX,m=g.endY-g.startY;switch(n){case"ne":a+=m,o+(r+=u)>c&&(p=!1),m<0&&a<=l&&(p=!1),s-=m;break;case"nw":o+=u,a+=m,u<0&&o<=h&&(p=!1),m<0&&a<=l&&(p=!1),r-=u,s-=m;break;case"se":o+(r+=u)>c&&(p=!1),a+(s+=m)>d&&(p=!1);break;case"sw":o+=u,u<0&&o<=h&&(p=!1),r-=u,a+(s+=m)>d&&(p=!1);break;case"all":(o+=u)+r>c&&(p=!1),(a+=m)+s>d&&(p=!1)}p&&(e.width=r,e.height=s,e.left=o,e.top=a,this.renderCropBox()),H(i,(t=>{t.startX=t.endX,t.startY=t.endY}))}},yt={scaleX(){var{scaleY:t,scaleX:e}=this.imageData;return this.scale(C(e)?-e:-1,C(t)?t:1)},scaleY(){var{scaleY:t,scaleX:e}=this.imageData;return this.scale(C(e)?e:1,C(t)?-t:-1)},scale(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,{imageData:i}=this,n=!1;return t=Number(t),e=Number(e),C(t)&&(i.scaleX=t,n=!0),C(e)&&(i.scaleY=e,n=!0),n&&(this.renderCanvas(!0,!0),this.renderCropBox()),this},rotate(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo(t){return C(t=Number(t))&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},getCroppedCanvas(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!window.HTMLCanvasElement)return null;var{canvasData:e}=this,i=pt(this.image,this.imageData,e,t),{x:n,y:o,width:a,height:r}=this.getData(),s=i.width/Math.floor(e.naturalWidth);1!==s&&(n*=s,o*=s,a*=s,r*=s);var h=a/r,l=ht({aspectRatio:h,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),c=ht({aspectRatio:h,width:t.minWidth||0,height:t.minHeight||0},"cover"),{width:d,height:p}=ht({aspectRatio:h,width:t.width||(1!==s?i.width:a),height:t.height||(1!==s?i.height:r)});d=Math.min(l.width,Math.max(c.width,d)),p=Math.min(l.height,Math.max(c.height,p));var g=document.createElement("canvas"),u=g.getContext("2d");g.width=dt(d),g.height=dt(p),u.fillStyle=t.fillColor||"transparent",u.fillRect(0,0,d,p);var{imageSmoothingEnabled:m=!0,imageSmoothingQuality:f}=t;u.imageSmoothingEnabled=m,f&&(u.imageSmoothingQuality=f);var v,w,b,x,y,D,C=i.width,M=i.height,S=n,T=o;S<=-a||S>C?(S=0,v=0,b=0,y=0):S<=0?(b=-S,S=0,y=v=Math.min(C,a+S)):S<=C&&(b=0,y=v=Math.min(a,C-S)),v<=0||T<=-r||T>M?(T=0,w=0,x=0,D=0):T<=0?(x=-T,T=0,D=w=Math.min(M,r+T)):T<=M&&(x=0,D=w=Math.min(r,M-T));var L=[S,T,v,w];if(y>0&&D>0){var W=d/a;L.push(b*W,x*W,y*W,D*W)}return u.drawImage(i,...L.map((t=>Math.floor(dt(t))))),g},getData(){var t,{imageData:e,canvasData:i,cropBoxData:n}=this;t={x:n.left-i.left,y:n.top-i.top,width:n.width,height:n.height};var o=e.width/e.naturalWidth;return H(t,((e,i)=>{t[i]=e/o})),t.rotate=e.rotate||0,t.scaleX=e.scaleX||1,t.scaleY=e.scaleY||1,t},toDataURL(){var{outPutImageType:t,outPutImageDefinition:e}=this.options;return this.getCroppedCanvas().toDataURL(t,e)},toBlob(t){var{outPutImageType:e,outPutImageDefinition:i}=this.options;this.getCroppedCanvas().toBlob(t,e,i)},destroy(){var{element:t}=this;if(!t.cropper)return this;t.cropper=void 0,t.src=this.originalUrl,this.unbind(),this.cropper.parentNode.removeChild(this.cropper),_(this.element,p)}};i(676);class Dt{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!l.test(t.tagName))throw new Error("主元素必须为<img> 或者 <canvas> 元素.");this.element=t,this.options=B({},b,W(e)&&e),this.pointers={},this.sized=!1,this.sizing=!1,this.init()}init(){var t,{element:e}=this,i=e.tagName.toLowerCase();if(!e.cropper){if(e.cropper=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}load(t){if(t){this.url=t,this.imageData={};var{element:e,options:i}=this;if(c.test(t))this.read(k(t));else{var n=new XMLHttpRequest,o=this.clone.bind(this);this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=()=>{},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.xhr=null},i.checkCrossOrigin&&X(t)&&e.crossOrigin&&(t=q(t)),n.open("GET",t),n.responseType="arraybuffer",n.withCredentials="use-credentials"===e.crossOrigin,n.send()}}}read(t){var{imageData:e}=this,i=Y(t),n=0,o=1,a=1;i>1&&(this.url=j(t,d),({rotate:n,scaleX:o,scaleY:a}=A(i))),e.rotate=n,e.scaleX=o,e.scaleY=a,this.clone()}clone(){var t,e,{element:i,url:n}=this;this.options.checkCrossOrigin&&X(n)&&(({crossOrigin:t}=i),t||(t="anonymous"),e=q(n)),this.crossOrigin=t,this.crossOriginUrl=e;var o=document.createElement("img");t&&(o.crossOrigin=t),o.src=e||n,this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),Q(o,g),i.parentNode.insertBefore(o,i.nextSibling)}start(){var t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var e=o.navigator&&/^(?:.(?!chrome|android))*safari/i.test(o.navigator.userAgent),i=(t,e)=>{B(this.imageData,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),this.sizing=!1,this.sized=!0,this.build()};if(!t.naturalWidth||e){var n=document.createElement("img"),a=document.body||document.documentElement;this.sizingImage=n,n.onload=()=>{i(n.width,n.height),e||a.removeChild(n)},n.src=t.src,e||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",a.appendChild(n))}else i(t.naturalWidth,t.naturalHeight)}stop(){var{image:t}=this;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}build(){if(this.sized){var{element:t,options:e,image:i}=this,n=t.parentNode,o=document.createElement("div");o.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var r=o.querySelector(".".concat(a,"-container")),s=r.querySelector(".".concat(a,"-canvas")),h=r.querySelector(".".concat(a,"-drag-box")),l=r.querySelector(".".concat(a,"-crop-box")),c=l.querySelector(".".concat(a,"-face"));this.container=n,this.cropper=r,this.canvas=s,this.dragBox=h,this.cropBox=l,this.viewBox=r.querySelector(".".concat(a,"-view-box")),this.face=c,s.appendChild(i),Q(t,p),n.insertBefore(r,t.nextSibling),this.isImg||_(i,g),Q(c,u),et(c,m,"all"),this.initPreview(),this.render(),this.bind(),"function"==typeof this.options.onReady&&this.options.onReady()}}}B(Dt.prototype,ft,vt,wt,bt,xt,yt);const Ct=Dt;var Mt="undefined"!=typeof window,St=Mt?window:{},Tt=!!Mt&&"ontouchstart"in St.document.documentElement,Lt=/^img|canvas$/i,Wt=/^data:image\/jpeg;base64,/,Rt="image/jpeg",Ot="doodle",Et="".concat(Ot,"-hide"),Ht="".concat(Ot,"-hidden"),Bt=Tt?"touchstart":"mousedown",Nt=Tt?"touchmove":"mousemove",Ut=Tt?"touchend touchcancel":"mouseup",It=(document.body.clientWidth||window.screen.availWidth)-10,kt=Math.ceil(.01*It),Pt=Math.ceil(.03*It),zt=Math.ceil(.04*It),Xt=Math.ceil(.05*It),jt=Math.ceil(.06*It),Yt=Math.ceil(.1*It);const At={initialAspectRatio:NaN,aspectRatio:NaN,outPutImageType:Rt,outPutImageDefinition:1,tool:"pencil",toolColor:"#000",pencilSize:"L",maxScale:2,minScale:1,scale:1,stepScaleNumber:.02},qt={render(){this.initContainer(),this.initCanvas(),this.initDoodleCanvas()},initContainer(){var{element:t,options:e,container:i,doodle:n}=this,o=i.getBoundingClientRect(),a={width:i.offsetWidth,height:i.offsetHeight,x:o.x,y:o.y};this.containerData=a,G(n,{width:a.width,height:a.height})},initCanvas(){var{containerData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,a=i?o/n:n/o,r=t.width,s=t.height;a>r/s?s=n>t.width?(r=t.width)/a:(r=n)/a:r=o>t.height?(s=t.height)*a:(s=o)*a;var h={aspectRatio:a,naturalWidth:n,naturalHeight:o,width:r*this.scale,height:s*this.scale};h.left=(t.width-h.width)/2,h.top=(t.height-h.height)/2,this.canvasData=h;var{canvas:l}=this;G(l,B({width:h.width,height:h.height},$({translateX:h.left,translateY:h.top}))),B(this.imageData,{width:h.width,height:h.height,left:0,top:0}),this.renderImage()},renderImage(){var{canvasData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=e.naturalWidth,o=e.naturalHeight;e.naturalWidth>t.width&&(i?(n=t.height,o=e.naturalWidth*(t.height/e.naturalHeight)):(n=t.width,o=e.naturalHeight*(t.width/e.naturalWidth))),this.imageData=B(e,{width:n,height:o,left:(t.width-n)/2,top:(t.height-o)/2}),G(this.image,B({width:e.width,height:e.height},$(B({translateX:e.left,translateY:e.top},e))))},initDoodleCanvas(){var{canvas:t,canvasData:e}=this,i=document.createElement("canvas");i.width=e.width,i.height=e.height,t.appendChild(i);var n=i.getContext("2d");this.doodleContext=n,this.doodleCanvas=i,this.renderDoodleContext()},renderDoodleContext(){var{tool:t,toolColor:e,pencilSize:i}=this.options,{doodleContext:n}=this;if("pencil"===t)switch(n.globalCompositeOperation="source-over",n.strokeStyle=e,i){case"S":n.lineWidth=this.calcPencilSize(kt);break;case"M":n.lineWidth=this.calcPencilSize(Pt);break;case"L":n.lineWidth=this.calcPencilSize(zt);break;case"XL":n.lineWidth=this.calcPencilSize(Xt);break;case"XXL":n.lineWidth=this.calcPencilSize(jt)}else"rubber"===t&&(n.globalCompositeOperation="destination-out",n.strokeStyle="#fff",n.lineWidth=Yt);n.lineJoin="round"},calcPencilSize(t){return this.scale>1?t/this.scale:t*this.scale}},$t={bind(){var{element:t,doodleCanvas:e}=this;rt(e,Bt,this.onDoodleStart=this.doodleStart.bind(this)),rt(e,Nt,this.onDoodleMove=this.doodleMove.bind(this)),rt(e,Ut,this.onDoodleEnd=this.doodleEnd.bind(this))},unbind(){var{element:t,doodleCanvas:e}=this;at(e,Bt,this.onDoodleStart),at(e,Nt,this.onDoodleMove),at(e,Ut,this.onDoodleEnd)}},Ft={doodleStart(t){var{pointers:e,doublePointers:i,options:n}=this;if(t.targetTouches){if(1===t.targetTouches.length)e[0]=st(t.targetTouches[0]);else if(2===t.targetTouches.length){var o=0;H(t.targetTouches,(t=>{i[o]=st(t),o++}))}}else e[0]=st(t);this.action=!0,t.preventDefault(),t.stopPropagation()},doodleMove(t){var{pointers:e,action:i,doublePointers:n,options:o}=this;if(i){if(t.targetTouches){if(1===t.targetTouches.length)B(e[0]||{},st(t.targetTouches[0],!0)),this.change(t);else if(2===t.targetTouches.length){var a=0;H(t.targetTouches,(t=>{B(n[a]||{},st(t,!0)),a++})),this.doubleFinger(t)}}else B(e[0]||{},st(t,!0)),this.change(t);t.preventDefault(),t.stopPropagation()}},doodleEnd(t){var{pointers:e,action:i,doublePointers:n,options:o,canvas:a}=this;if("zoom"===o.tool&&(this.canvasData.left=a.getBoundingClientRect().left,this.canvasData.top=a.getBoundingClientRect().top),this.doubleFingerRange=0,t.targetTouches){var r=0;H(t.targetTouches,(t=>{delete e[r],delete n[r],r++}))}else delete e[0];i&&(Object.keys(e).length||(this.action=!1),t.preventDefault(),t.stopPropagation())}},Gt={change(t){var{pointers:e,doodleContext:i,canvasData:n,containerData:o,options:a,canvas:r}=this,s=e[Object.keys(e)[0]],{startX:h,startY:l,endX:c,endY:d}=s;if("zoom"===a.tool){var p,g,u=n.width-o.width,m=n.height-o.height,f=c-h,v=d-l;return p=u>0?f<0?n.left+f<-u?-u:n.left+f:n.left+f>0?0:n.left+f:n.left,g=m>0?v<0?n.top+v<-m?-m:n.top+v:n.top+v>0?0:n.top+v:n.top,void G(r,B({width:n.width,height:n.height},$({translateX:p,translateY:g})))}h-=n.left+o.x,l-=n.top+o.y,c-=n.left+o.x,d-=n.top+o.y,this.doodleData.push({pointer:{startX:h,startY:l,endX:c,endY:d,scale:this.scale},tool:a.tool,toolColor:a.toolColor,pencilSize:this.doodleContext.lineWidth}),h/=this.scale,l/=this.scale,c/=this.scale,d/=this.scale,i.beginPath(),i.moveTo(h,l),i.lineTo(c,d),i.closePath(),i.stroke(),H(e,(t=>{t&&(t.startX=t.endX,t.startY=t.endY)}))},doubleFinger(){var{doublePointers:t,doubleFingerRange:e}=this,i=t[0],n=t[1],o=Math.abs(n.endY-i.endY);e<o?this.enlarge():this.reduce(),this.doubleFingerRange=o}},Jt={pencil(){this.options.tool="pencil",this.renderDoodleContext()},rubber(){this.options.tool="rubber",this.renderDoodleContext()},zoom(){this.options.tool="zoom"},pencilColor(t){this.options.toolColor=t,this.renderDoodleContext()},pencilSize(t){this.options.pencilSize=t,this.renderDoodleContext()},getDoodleCanvas(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{canvasData:e,doodleData:i,containerData:n}=this;if(!window.HTMLCanvasElement||0===i.length)return{toDataURL:()=>null,toBlob:()=>null};1!==this.scale&&(this.scale=1,this.reDraw()),e.top=dt(e.top);var o=pt(this.image,this.imageData,e,t),a=o.getContext("2d"),r=document.createElement("canvas");r.width=dt(o.width),r.height=dt(o.height);var s=r.getContext("2d"),h=Math.abs(this.imageData.rotate)%180==90,l=e.naturalWidth/n.width*(h?this.imageData.aspectRatio:1);return H(i,((t,e)=>{"pencil"===t.tool?(s.globalCompositeOperation="source-over",s.strokeStyle=t.toolColor,s.lineWidth=t.pencilSize*l):"rubber"===t.tool&&(s.globalCompositeOperation="destination-out",s.strokeStyle="#ffffff",s.lineWidth=Yt*l),s.lineJoin="round";var{startX:i,startY:n,endX:o,endY:a,scale:r}=t.pointer;i=i/r*l,n=n/r*l,o=o/r*l,a=a/r*l,s.beginPath(),s.moveTo(i,n),s.lineTo(o,a),s.closePath(),s.stroke()})),a.drawImage(r,0,0,o.width,o.height),o},toDataURL(){var{outPutImageType:t,outPutImageDefinition:e}=this.options;return this.getDoodleCanvas().toDataURL(t,e)},toBlob(t){var{outPutImageType:e,outPutImageDefinition:i}=this.options;this.getDoodleCanvas().toBlob(t,e,i)},destroy(){var{element:t}=this;if(!t.doodle)return this;t.doodle=void 0,t.src=this.originalUrl,this.doodleData=[],this.unbind(),this.doodle.parentNode.removeChild(this.doodle),_(this.element,Ht)},enlarge(){this.options.tool="zoom",this.scale+=this.stepScaleNumber,this.scale=this.scale>this.maxScale?this.maxScale:this.scale,this.reDraw()},reduce(){this.options.tool="zoom",this.scale-=this.stepScaleNumber,this.scale=this.scale<this.minScale?this.minScale:this.scale,this.reDraw()},reDraw(){this.initContainer(),this.initCanvas(),this.pencilSize(this.options.pencilSize)}};i(511);class Qt{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!Lt.test(t.tagName))throw new Error("主元素必须为<img> 或者 <canvas> 元素.");this.element=t,this.options=B({},At,W(e)&&e),this.sized=!1,this.pointers=[],this.doodleData=[],this.doublePointers=[],this.doubleFingerRange=0,this.scale=this.options.scale,this.maxScale=this.options.maxScale,this.minScale=this.options.minScale,this.stepScaleNumber=this.options.stepScaleNumber,this.toolChange=this.options.toolChange;var i=this.options.tool;Object.defineProperty(this.options,"tool",{get:()=>i,set(t){this.toolChange&&this.toolChange(t),i=t}}),this.init()}init(){var t,{element:e}=this,i=e.tagName.toLowerCase();if(!e.doodle){if(e.doodle=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}load(t){if(t){this.url=t,this.imageData={};var{element:e,options:i}=this;if(Wt.test(t))this.read(k(t));else{var n=new XMLHttpRequest,o=this.clone.bind(this);this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=()=>{},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.xhr=null},i.checkCrossOrigin&&X(t)&&e.crossOrigin&&(t=q(t)),n.open("GET",t),n.responseType="arraybuffer",n.withCredentials="use-credentials"===e.crossOrigin,n.send()}}}read(t){var{imageData:e}=this,i=Y(t),n=0,o=1,a=1;i>1&&(this.url=j(t,Rt),({rotate:n,scaleX:o,scaleY:a}=A(i))),e.rotate=n,e.scaleX=o,e.scaleY=a,this.clone()}clone(){var t,e,{element:i,url:n}=this;this.options.checkCrossOrigin&&X(n)&&(({crossOrigin:t}=i),t||(t="anonymous"),e=q(n)),this.crossOrigin=t,this.crossOriginUrl=e;var o=document.createElement("img");t&&(o.crossOrigin=t),o.src=e||n,this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),Q(o,Et),i.parentNode.insertBefore(o,i.nextSibling)}start(){var t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var e=St.navigator&&/^(?:.(?!chrome|android))*safari/i.test(St.navigator.userAgent),i=(t,e)=>{B(this.imageData,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),this.sizing=!1,this.sized=!0,this.build()};if(!t.naturalWidth||e){var n=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=n,n.onload=()=>{i(n.width,n.height),e||o.removeChild(n)},n.src=t.src,e||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(n))}else i(t.naturalWidth,t.naturalHeight)}stop(){var{image:t}=this;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}build(){if(this.sized){var{element:t,options:e,image:i}=this,n=t.parentNode,o=document.createElement("div");o.innerHTML='<div class="doodle-container" touch-action="none"><div class="doodle-wrap-box"><div class="doodle-canvas"></div></div></div>';var a=o.querySelector(".".concat(Ot,"-container")),r=a.querySelector(".".concat(Ot,"-canvas")),s=o.querySelector(".".concat(Ot,"-wrap-box"));this.container=n,this.doodle=a,this.canvas=r,this.doodleWrapBox=s,r.appendChild(i),Q(t,Ht),n.insertBefore(a,t.nextSibling),this.render(),this.bind()}}}B(Qt.prototype,qt,$t,Ft,Gt,Jt);const _t=Qt;var Vt="undefined"!=typeof window?window:{},Zt=/^img|canvas$/i,Kt=/^data:image\/jpeg;base64,/,te="image/jpeg",ee="discoloration",ie="".concat(ee,"-hide"),ne="".concat(ee,"-hidden");const oe={outPutImageType:te,outPutImageDefinition:1},ae={render(){this.initContainer(),this.initCanvas()},initContainer(){var{container:t,discoloration:e}=this,i={width:t.offsetWidth,height:t.offsetHeight};this.containerData=i,G(e,{width:i.width,height:i.height})},initCanvas(){var{containerData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,a=n/o,r=t.width,s=t.height;a>r/s?s=n>t.width?(r=t.width)/a:(r=n)/a:r=o>t.height?(s=t.height)*a:(s=o)*a;var h={aspectRatio:a,naturalWidth:n,naturalHeight:o,width:r,height:s};h.left=(t.width-r)/2,h.top=(t.height-s)/2,this.canvasData=h;var{canvas:l}=this;G(l,B({width:h.width,height:h.height},$({translateX:h.left,translateY:h.top}))),B(this.imageData,{width:h.width,height:h.height,left:0,top:0}),this.renderImage()},renderImage(){var{canvasData:t,imageData:e}=this,i=Math.abs(e.rotate)%180==90,n=e.naturalWidth,o=e.naturalHeight;e.naturalWidth>t.width&&(i?(n=t.height,o=e.naturalWidth*(t.height/e.naturalHeight)):(n=t.width,o=e.naturalHeight*(t.width/e.naturalWidth))),this.imageData=B(e,{width:n,height:o,left:(t.width-n)/2,top:(t.height-o)/2}),G(this.image,B({width:e.width,height:e.height},$(B({translateX:e.left,translateY:e.top},e))))}},re={getDiscoloration(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!window.HTMLCanvasElement)return null;for(var{canvasData:e}=this,i=pt(this.image,this.imageData,e,t),n=i.getContext("2d"),o=n.getImageData(0,0,i.width,i.height),a=o.data,r=0,s=a.length;r<s;r+=4){var h=(a[r]+a[r+1]+a[r+2])/3;a[r]=h,a[r+1]=h,a[r+2]=h}return n.putImageData(o,0,0),i},toDataURL(){var{outPutImageType:t,outPutImageDefinition:e}=this.options;return this.getDiscoloration().toDataURL(t,e)},toBlob(t){var{outPutImageType:e,outPutImageDefinition:i}=this.options;this.getDiscoloration().toBlob(t,e,i)},destroy(){var{element:t}=this;if(!t.discoloration)return this;t.discoloration=void 0,t.src=this.originalUrl,this.discoloration.parentNode.removeChild(this.discoloration),_(this.element,ne)}};i(89);class se{constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!Zt.test(t.tagName))throw new Error("主元素必须为<img> 或者 <canvas> 元素.");this.element=t,this.options=B({},oe,W(e)&&e),this.sized=!1,this.init()}init(){var t,{element:e}=this,i=e.tagName.toLowerCase();if(!e.discoloration){if(e.discoloration=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}load(t){if(t){this.url=t,this.imageData={};var{element:e,options:i}=this;if(Kt.test(t))this.read(k(t));else{var n=new XMLHttpRequest,o=this.clone.bind(this);this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=()=>{},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.xhr=null},i.checkCrossOrigin&&X(t)&&e.crossOrigin&&(t=q(t)),n.open("GET",t),n.responseType="arraybuffer",n.withCredentials="use-credentials"===e.crossOrigin,n.send()}}}read(t){var{imageData:e}=this,i=Y(t),n=0,o=1,a=1;i>1&&(this.url=j(t,te),({rotate:n,scaleX:o,scaleY:a}=A(i))),e.rotate=n,e.scaleX=o,e.scaleY=a,this.clone()}clone(){var t,e,{element:i,url:n}=this;this.options.checkCrossOrigin&&X(n)&&(({crossOrigin:t}=i),t||(t="anonymous"),e=q(n)),this.crossOrigin=t,this.crossOriginUrl=e;var o=document.createElement("img");t&&(o.crossOrigin=t),o.src=e||n,this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),Q(o,ie),i.parentNode.insertBefore(o,i.nextSibling)}start(){var t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var e=Vt.navigator&&/^(?:.(?!chrome|android))*safari/i.test(Vt.navigator.userAgent),i=(t,e)=>{B(this.imageData,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),this.sizing=!1,this.sized=!0,this.build()};if(!t.naturalWidth||e){var n=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=n,n.onload=()=>{i(n.width,n.height),e||o.removeChild(n)},n.src=t.src,e||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(n))}else i(t.naturalWidth,t.naturalHeight)}stop(){var{image:t}=this;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}build(){if(this.sized){var{element:t,options:e,image:i}=this,n=t.parentNode,o=document.createElement("div");o.innerHTML='<div class="discoloration-container" touch-action="none"><div class="discoloration-wrap-box"><div class="discoloration-canvas"></div></div></div>';var a=o.querySelector(".".concat(ee,"-container")),r=a.querySelector(".".concat(ee,"-canvas"));this.container=n,this.discoloration=a,this.canvas=r,r.appendChild(i),Q(t,ne),n.insertBefore(a,t.nextSibling),this.render()}}}B(se.prototype,ae,re);const he=se})(),n})()}));